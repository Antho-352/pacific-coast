name: ðŸš€ Deploy to cPanel

  on:
    push:
      branches: [ main ]
    workflow_dispatch:

  jobs:
    deploy:
      runs-on: ubuntu-latest

      steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ðŸš€ Deploy to cPanel
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.CPANEL_HOST }}
          username: ${{ secrets.CPANEL_USER }}
          password: ${{ secrets.CPANEL_PASSWORD }}
          port: 22
          script: |
            cd /home/hondapacificcoas/repositories/pacific-coast/
            git pull origin main
            /opt/cpanel/ea-nodejs20/bin/npm install
            /opt/cpanel/ea-nodejs20/bin/npm run build
            rm -rf /home/hondapacificcoas/public_html/*
            cp -R /home/hondapacificcoas/repositories/pacific-coast/dist/* /home/hondapacificcoas/public_html/
            echo "âœ… DÃ©ploiement terminÃ© le $(date)"
