---
deployment:
  tasks:
    # DÃ©finition des variables
    - export DEPLOYPATH=/home/hondapacificcoas/public_html/
    - export REPO_PATH=/home/hondapacificcoas/repositories/pacific-coast/
    
    # Log de dÃ©but
    - echo "[$(date)] ðŸš€ DÃ©marrage du dÃ©ploiement automatique" >> /home/hondapacificcoas/deploy.log
    
    # Installation des dÃ©pendances
    - cd $REPO_PATH && /opt/cpanel/ea-nodejs20/bin/npm install >> /home/hondapacificcoas/deploy.log 2>&1
    
    # Build
    - cd $REPO_PATH && /opt/cpanel/ea-nodejs20/bin/npm run build >> /home/hondapacificcoas/deploy.log 2>&1
    
    # DÃ©ploiement avec rsync (protÃ¨ge /magazine et autres dossiers WordPress)
    - /usr/bin/rsync -av --delete --exclude='/magazine' --exclude='/wp-content' --exclude='/.htaccess' --exclude='/wp-admin' --exclude='/wp-includes' $REPO_PATH/dist/ $DEPLOYPATH/ >> /home/hondapacificcoas/deploy.log 2>&1
    
    # Log de fin
    - echo "[$(date)] âœ… DÃ©ploiement terminÃ©" >> /home/hondapacificcoas/deploy.log
